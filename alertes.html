<!DOCTYPE HTML>
<html>

    <head title="Parcelles GEA">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0 minimal-ui"/>
        <meta name="apple-mobile-web-app-capable" content="yes"/>
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="images/splash/splash-icon.png">
        <link rel="apple-touch-startup-image" href="images/splash/splash-screen.png" 			media="screen and (max-device-width: 320px)" />
        <link rel="apple-touch-startup-image" sizes="640x1096" href="images/ios/splash/splash-screen@3x.png"/>
        <link rel="apple-touch-startup-image" sizes="1024x748" href="images/ios/splash/splash-screen-ipad-landscape" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : landscape)" />
        <link rel="apple-touch-startup-image" sizes="768x1004" href="images/ios/splash/splash-screen-ipad-portrait.png" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : portrait)" />
        <title>Parcelles GEA</title>
        <link href="css/framework.min.css" 	  rel="stylesheet" type="text/css"/>
        <link href="css/owl.theme.min.css"    rel="stylesheet" type="text/css"/>
        <link href="css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
        <link href="css/style.css"     	  rel="stylesheet" type="text/css"/>
        <style type="text/css">
            body {
                margin: 0;
                -webkit-tap-highlight-color:rgba(0,0,0,0);
            }
            div#container {
                position: absolute;
                width: 100%;
                top: 0;
                bottom: 0;
            }
            div[data-role="header"] {
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
            }
            div[data-role="content"] {
                position: absolute;
                top: 41px;
                bottom: 0;
                left: 0;
                right: 0;
            }
            .scrollable {
                overflow-y: scroll;
                -webkit-overflow-scrolling: touch;
                -webkit-overflow-scrolling: touch;
            }
            .scrollable > * {
                -webkit-transform: translateZ(0px);
            }
            .tache-div{
                padding-left: 5px;
                padding-right: 5px
            }
        </style>

        <script type="text/javascript" src="js/jquery.min.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/custom.js"></script>
        <script type="text/javascript" src="js/framework.plugins.min.js"></script>
        <script type="text/javascript">
            function clearRadio(nom) {
                if (nom) {
                    jQuery("input:radio[name='" + nom + "']").each(function (i) {
                        this.checked = false;
                    });
                }
            }
            function loadContent(url) {
                jQuery('#ajax-content').load(url);
            }

            function quitter() {
                if (confirm("Voulez-vous vraiment quitter l'application")) {
                    navigator.app.exitApp();
                } 
            }

            document.addEventListener("backbutton", function (e) {
                document.location('accueil.html');
            }, false);

        </script>
    </head>
    <body onload="">
        <div class="scrollable" id="container">
            <div class="snap-drawers">
                <div class="snap-drawer snap-drawer-left">
                    <div class="sidebar-header">
                        <a href="#" class="sidebar-logo"><h2 style="color: #27AE60"> Parcelles GEA </h2></a>
                        <a href="#" class="sidebar-logo-close" style="font-size: 18px"><i class="fa fa-arrow-circle-left default-color"></i></a>
                    </div>
                    <div class="clear"></div>
                    <ul class="sidebar-navigation full-bottom">
                        <li><a  href="accueil.html"><i style="margin-top: 6px"><img src="images/HOME.png"  alt="home" style="width: 32px; height: 32px" /></i><em style="padding-left: 80px; padding-top: 20px">Accueil</em></a></li>
                        <li><a  href="parcelles-liste.html"><i style="margin-top: 6px"><img src="images/PARCELLE.png"  alt="Parcelles" style="width: 32px; height: 32px" /></i><em style="padding-left: 80px; padding-top: 20px">Parcelles</em></a></li>
                        <li><a  href="alertes.html"><i style="margin-top: 6px"><img src="images/alert.png"  alt="Alertes" style="width: 32px; height: 32px" /></i><em style="padding-left: 80px; padding-top: 20px">Alertes</em></a></li>
                        <li><a  onclick="quitter()"><i style="margin-top: 6px"><img src="images/CANCEL.png"  alt="Alertes" style="width: 32px; height: 32px" /></i><em style="padding-left: 80px; padding-top: 20px">Quitter</em></a></li>
                    </ul>
                    <div class="sidebar-decoration"></div>

                    <div class="sidebar-decoration"></div>
                </div>
            </div>

            <div class="page-header">
                <a href="#" class="open-left"><i class="fa fa-navicon"></i></a>
                <a class="page-logo"><span id="titreHeder"><img src="images/alert.png" alt="" style="width: 48px; height: 48px; display: inline;"/> Alertes</span></a>
                <!--<a href="accueil.html" id="backbutton" class="open-right1 cursor"><i style="color: #FFF" class="fa fa-arrow-left"></i></a>-->
            </div>
            <div id="content" class="snap-content">
                <div id="ajax-content" style="" class="scroller">
                    <div style=" padding-top: 60px;">
                        <table style="padding: 1px; margin-bottom: 2px" class="table">
                            <tr style=" padding: 2px; margin: 2px; font-size: 20px">
                                <td style="padding: 2px; margin: 2px; width: 50%">
                                    <a href="new-alerte.html" style="width: 100%; text-align: center; border-radius: 10px; text-align: center; color: #27AE60" class="button-3d"><img src="images/ADD_GRN.png"  alt="Alertes" style="width: 30px; height: 30px; display: inline-block; margin-bottom: -7px" /> Ajouter</a>
                                </td>
                                <td  style=" padding: 2px; margin: 2px; width: 50%">
                                    <a href="alertes-map.html" style="width: 100%; text-align: center; border-radius: 10px; color: #27AE60" class=" button-3d"><img src="images/map.png"  alt="Alertes" style="width: 30px; height: 30px; display: inline-block; margin-bottom: -7px" /> Carte</a>
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="header-menu" id="listeAlertes" style="margin: 1px 10px 1px 10px;">
                        <img id="loading" style="text-align: center; margin-left: auto; margin-right: auto; width: 100%" src="images/loading.gif" alt="Chargement en cours..."/>
                    </div>
                </div>
            </div>
        </div>
        <script type="text/javascript">
            jQuery.ajax({
                'type': 'GET',
                'url': "http://geoland.noflay.com/server/alertes.php",
                'data': {'user': 1},
                'dataType': 'JSON',
                'success': function (resultat) {
                    alert(resultat.length + ' Alertes trouvées');
                    jQuery('#loading').hide();
                    for (var i = 0; i < resultat.length; i++) {
                        if (resultat[i].libelle) {

                            var idalerte = resultat[i].id;
                            var titre = resultat[i].libelle;
                            var description = resultat[i].description;
                            var fichier = resultat[i].fichier;
                            var imgfichier = '';
                            if (fichier) {
                                imgfichier = "<img style=\"width: 90%; margin-left:auto; margin-right: auto\" src=\"http://geoland.noflay.com/server/alertes/fichiers/" + fichier + "\"/>";
                            }
                            var alertesdiv = "<div class=\"alerte-div\"><a class=\"alerte cursor\"> <i class=\"fa fa-exclamation-triangle\"></i> " + titre + "<i class=\"fa fa-plus\"></i></a><div style=\"display: none;\" class=\"alerte-content\"><div><p>" + description + "</p></div><br/><div>" + imgfichier + "</div></div></div>";
                            jQuery('#listeAlertes').append(alertesdiv);
                        }
                    }
                },
                'error': function () {
                    alert('une erreur est survenue lors de la recupération des alertes. Merci de réessayer');
                }
            });

            jQuery(document).on("click", '.alerte', function () {
                if (jQuery(this).hasClass('alerte-active')) {
                    jQuery(this).parent().find('.alerte-content').hide('200');
                    jQuery(this).parent().find('.fa').removeClass('fa-minus');
                    jQuery(this).parent().find('.fa').addClass('fa-plus');
                    jQuery(this).removeClass('alerte-active');
                } else {
                    jQuery(this).parent().find('.alerte-content').show('200');
                    jQuery(this).parent().find('.fa').removeClass('fa-plus');
                    jQuery(this).parent().find('.fa').addClass('fa-minus');
                    jQuery(this).addClass('alerte-active');
                    jQuery(this).css('background-color', '#9CE5BA');
                    jQuery(this).parent().css('background-color', '#EFF2F0');
                    jQuery(this).parent().css('border', 'solid 1px #9CE5BA');
                }
            });

        </script>
    </body>

</html>
